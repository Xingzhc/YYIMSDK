YYIMChat=function(e){var r=e.constructor,t=function(){function t(t){if(!0===t.accountMmanaged){var n={etpId:e.getConfig().MULTI_TENANCY.ETP_KEY,appId:e.getConfig().MULTI_TENANCY.APP_KEY,caller:t.caller,phones:t.phones,username:r.getInstance().getUserNode()};jQuery.ajax({url:e.getConfig().SERVLET.REST_USER_SERVLET+"voip/make?token="+r.getInstance().getToken(),type:"post",data:JSON.stringify(n),dataType:"json",cache:!1,processData:!1,contentType:"application/json",headers:{},success:t.success,error:function(e){try{t.error&&t.error(JSON.parse(e.responseText)),t=null}catch(e){t.error&&t.error(),t=null}}})}else{var o=(new Date).getTime(),n={caller:t.caller,phones:t.phones,account_identify:t.account,userId:r.getInstance().getUserBareJID(),timestamp:o,sign:hex_sha1(t.account+t.key+o)};jQuery.ajax({url:e.getConfig().MULTIPARTYCALL.ADDRESS,type:"get",data:n,dataType:"jsonp",cache:!1,jsonp:"callback",success:t.success,error:function(e){try{t.error&&t.error(JSON.parse(e.responseText)),t=null}catch(e){t.error&&t.error(),t=null}}})}}function n(r){var t,n=0;jQuery.ajax({url:e.getConfig().SERVLET.REST_SYSTEM_SERVLET+"time",type:"get",cache:!1,beforeSend:function(){t=(new Date).getTime()},success:function(e){n=(new Date).getTime(),r&&r.success&&r.success(e-(t+n)/2,n-t),r=null},error:function(e){try{r.error&&r.error(JSON.parse(e.responseText)),r=null}catch(e){r.error&&r.error(),r=null}}})}function o(r){e.getConfig().TIMECORRECTION.LOAD?r&&r(e.getConfig().TIMECORRECTION.RESULT):n({success:function(t,n){if(n<e.getConfig().TIMECORRECTION.RESIDUAL)return e.getConfig().TIMECORRECTION.LOAD=!0,e.getConfig().TIMECORRECTION.RESULT=Math.round(t),r&&r(e.getConfig().TIMECORRECTION.RESULT);if(a.push(t),a.length<e.getConfig().TIMECORRECTION.TIMES)o(r);else{var i=0;for(var c in a)YYIMUtil.isWhateType(a[c],"Number")&&(i+=a[c]);a.length=0,e.getConfig().TIMECORRECTION.LOAD=!0,e.getConfig().TIMECORRECTION.RESULT=Math.round(i/e.getConfig().TIMECORRECTION.TIMES),r&&r(e.getConfig().TIMECORRECTION.RESULT)}}})}var a=[];return{multiPartyCall:t,getTimeCorrection:o}}();return r.prototype.multiPartyCall=function(r){if(void 0===r||void 0===r.caller||!YYIMArrayUtil.isArray(r.phones)||!r.phones.length)return void(r.error&&r.error());if(!YYIMRegExp.phone.test(r.caller))return void(r.error&&r.error());var n=[];for(var o in r.phones){var a=r.phones[o].toString();if(YYIMRegExp.phone.test(a)&&-1===n.indexOf(a)){n.push(a);var i=n.join(",");if(n.length>e.getConfig().MULTIPARTYCALL.PARTYMAXLENGTH||i.length>e.getConfig().MULTIPARTYCALL.PHONESMAXLENGTH){n.pop();break}}}return n.length?(r.caller=r.caller.toString(),r.phones=n,!0!==r.accountMmanaged&&(r.phones=n.join(","),r.account=r.account?r.account:e.getConfig().MULTIPARTYCALL.ACCOUNT,r.key=r.key?r.key:e.getConfig().MULTIPARTYCALL.KEY,void 0===r.account||void 0===r.key)?void(r.error&&r.error()):void t.multiPartyCall(r)):void(r.error&&r.error())},r.prototype.getTimeCorrection=function(e){t.getTimeCorrection(e)},r.getInstance()}(YYIMChat);